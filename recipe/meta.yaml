{% set version = "0.11.0" %}

package:
  name: pytest-jupyter-split
  version: {{ version }}

source:
  url: https://pypi.org/packages/source/p/pytest-jupyter/pytest_jupyter-{{ version }}.tar.gz
  sha256: a4e08ced44cfea1bce080090c626b8dc4f9d617fa5aafcd84b71405f503e9899

build:
  number: 1
  skip: true  # [py<310]

requirements:
  host:
    - python

outputs:
  - name: pytest-jupyter
    script: build-pkg.bat  # [win]
    script: build-pkg.sh   # [unix]
    requirements:
      host:
        - python
        - pip
        - hatchling >=1.10.0
      run:
        - python
        - jupyter_core >=5.7
        - pytest >=7.0
      run_constrained:
        - jupyter_server >=1.21
        - jupyter_client >=7.4.0
        - ipykernel >=6.14
        - nbformat >=5.3
    test:
      source_files:
        - tests
      imports:
        - pytest_jupyter
        - pytest_jupyter.jupyter_core
      commands:
        - pip check
        - python -c "from importlib.metadata import version; assert(version('pytest-jupyter')=='{{ version }}')"
      requires:
        - python
        - pip
  - name: pytest-jupyter-client
    requirements:
      host:
        - python
      run:
        - {{ pin_subpackage("pytest-jupyter", max_pin="x.x.x") }}
        - ipykernel >=6.14
        - jupyter_client >=7.4.0
        - nbformat >=5.3
        - python
    test:
      imports:
        - pytest_jupyter
        - pytest_jupyter.jupyter_client
      commands:
        - pip check
      requires:
        - pip
  - name: pytest-jupyter-server
    requirements:
      host:
        - python
      run:
        - {{ pin_subpackage("pytest-jupyter-client", max_pin="x.x.x") }}
        - jupyter_server >=1.21
        - jupyter_client >=7.4.0
        - nbformat >=5.3
        - ipykernel >=6.14
        - python
    test:
      source_files:
        - tests
      imports:
        - pytest_jupyter
        - pytest_jupyter.jupyter_server
      commands:
        - pip check
        - pytest -ra -vv tests
      requires:
        - pip

about:
  home: https://pypi.org/project/pytest-jupyter
  description: A pytest plugin used for testing Jupyter libraries and extensions.
  summary: |
    Pytest plugin that provides a set of fixtures and markers for testing Jupyter notebooks and
    Jupyter kernel sessions using the Pytest framework. This package allows developers to run
    tests on Jupyter notebooks as if they were regular Python modules.
  doc_url: https://pytest-jupyter.readthedocs.io/en/main
  dev_url: https://github.com/jupyter-server/pytest-jupyter
  license: BSD-3-Clause
  license_file: LICENSE
  license_family: BSD

extra:
  feedstock-name: pytest-jupyter
  recipe-maintainers:
    - blink1073
    - fcollonval
    - conda-forge/jupyter_server
